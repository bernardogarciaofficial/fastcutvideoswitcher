<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ğŸ¬ FastCut Music Video Switcher</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Orbitron:700|Montserrat:400,700&display=swap">
</head>
<body>
  <div class="theme-bg"></div>
  <div class="set-lights">
    <div class="spotlight spotlight-left"></div>
    <div class="spotlight spotlight-right"></div>
    <div class="spotlight spotlight-top"></div>
  </div>
  <header class="hollywood-header">
    <span class="camera-icon">ğŸ¥</span>
    <h2>FastCut Music Video Switcher</h2>
    <span class="clapperboard-icon">ğŸ¬</span>
    <div class="lights-action">LIGHTS <span class="dot">â€¢</span> CAMERA <span class="dot">â€¢</span> ACTION!</div>
    <div class="members-counter" id="membersCounter">
      <span class="counter-icon">ğŸ§‘â€ğŸ¤â€ğŸ§‘</span>
      <span id="membersCountNumber">15,347</span> members online
    </div>
  </header>

  <!-- Step 1: Audio Upload -->
  <div class="audio-track-block">
    <label for="songInput"><b><span class="music-icon">ğŸµ</span> Main Music Track:</b></label>
    <input type="file" id="songInput" accept=".mp3,.wav,.ogg,.m4a,.aac,.flac,.aiff,audio/*">
    <span id="audioStatus"></span>
    <audio id="audio" controls style="display:none"></audio>
  </div>

  <!-- Main Video Recording Screen (NEW) -->
  <div class="main-recorder-section">
    <h3>Step 1.5: Record Your Main Video Take</h3>
    <video id="mainRecorderPreview" width="600" height="340" autoplay muted></video>
    <div class="main-recorder-controls">
      <button id="mainRecorderRecordBtn" class="main-recorder-btn custom-record-btn">âºï¸ Record</button>
      <button id="mainRecorderStopBtn" class="main-recorder-btn custom-stop-btn" disabled>â¹ï¸ Stop</button>
      <button id="mainRecorderDownloadBtn" class="main-recorder-btn custom-download-btn" disabled>â¬‡ï¸ Download</button>
      <span id="mainRecorderStatus" class="main-recorder-status"></span>
    </div>
    <div class="take-instructions">
      <span>Record your main video take synced to the audio track. Download and use it as one of your 4 takes below!</span>
    </div>
  </div>

  <!-- Step 2: Upload Takes for 4-Track Switching -->
  <div class="switcher-upload-section">
    <h3>Step 2: Upload Your 4 Takes</h3>
    <div id="switcherTracks" class="switcher-track-grid-row"></div>
  </div>

  <!-- Step 3: Live Switch and Record -->
  <div class="switcher-control-section">
    <div class="switcher-live-controls">
      <button id="startSwitchingBtn" class="live-switch-btn record-btn" disabled>âºï¸ Start Switching</button>
      <button id="stopSwitchingBtn" class="live-switch-btn stop-btn" disabled>â¹ï¸ Stop Switching</button>
    </div>
    <div id="fastcutSwitcher" class="fastcut-switcher compact"></div>
    <div class="switching-instructions">
      <span>
        <b>How it works:</b> Once all takes are uploaded, click <b>Start Switching</b>, then switch cameras live by pressing the camera buttons below. When you're done, click <b>Stop Switching</b> to generate your master video!
      </span>
    </div>
  </div>

  <!-- Step 4: FastCut Switcher/Export -->
  <div class="master-output-section">
    <h3 class="output-title">Master Output Video <span class="filmstrip">ğŸï¸</span></h3>
    <video id="masterOutputVideo" controls width="600" height="340"></video>
    <div id="exportStatus" class="export-status"></div>
    <div id="syncInstructions" class="sync-instructions">
      <strong>How to Fix Audio/Video Sync in Your Editor:</strong>
      <ol>
        <li>Import your exported FastCut video into your video editor.</li>
        <li>Right-click the video clip and choose <b>"Unlink"</b> or <b>"Detach Audio"</b>.</li>
        <li>Select the audio track and move it forward by about <b>5â€“6 frames</b> (about 0.2 seconds), or until the music matches the video action.</li>
      </ol>
      <span class="sync-note">Tip: In most editors, you can nudge the audio by single frames using the arrow keys.</span>
    </div>
  </div>

  <canvas id="mixCanvas" width="600" height="340" style="display:none"></canvas>

  <footer class="hollywood-footer">
    <span class="clapperboard-icon">ğŸ¬</span>
    <span>FastCut by <b>bernardogarciaofficial</b> | <span class="camera-icon">ğŸ¥</span></span>
  </footer>
  <script src="script.js"></script>
</body>
</html>
